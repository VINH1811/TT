<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ch√∫c m·ª´ng T·∫øt Trung Thu ‚Äî 3D Parallax</title>
  <meta name="description" content="Thi·ªáp Trung Thu 3D: ƒë√®n l·ªìng bay, hi·ªáu ·ª©ng parallax theo chu·ªôt, l·ªùi ch√∫c tu·ª≥ bi·∫øn qua URL (?to=&from=&msg=)." />
  <style>
    :root{
      --bg1:#070a1b; /* deep night */
      --bg2:#111b3a;
      --moon:#ffe9b0;
      --accent:#ffb300;
      --pink:#ff8fb1;
      --cyan:#8de0ff;
      --glass: rgba(255,255,255,.07);
      --stroke: rgba(255,255,255,.18);
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", sans-serif;
      color:#fff; background: radial-gradient(85% 100% at 50% 20%, var(--bg2), var(--bg1));
      overflow:hidden; /* keep scene clean */
    }

    /* ====== Scene with 3D perspective ====== */
    .viewport{ position:relative; width:100%; height:100%; perspective: 1000px; overflow:hidden; }
    .scene{ position:absolute; inset:0; transform-style: preserve-3d; transition: transform .1s linear; }

    /* ====== Sky elements ====== */
    .stars{ position:absolute; inset:-10%; background: transparent; z-index:1; pointer-events:none }
    .stars::before, .stars::after{
      content:""; position:absolute; inset:0; background-repeat:repeat; opacity:.9;
      background-image:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.95) 50%, transparent 51%),
        radial-gradient(1px 1px at 65% 70%, rgba(255,255,255,.8) 50%, transparent 51%),
        radial-gradient(1.5px 1.5px at 78% 42%, rgba(255,255,255,.85) 50%, transparent 51%),
        radial-gradient(1px 1px at 35% 85%, rgba(255,255,255,.7) 50%, transparent 51%),
        radial-gradient(1px 1px at 10% 60%, rgba(255,255,255,.6) 50%, transparent 51%);
      animation: twinkle 6s linear infinite; filter: drop-shadow(0 0 2px rgba(255,255,255,.3));
    }
    .stars::after{ animation-direction:reverse; opacity:.6 }
    @keyframes twinkle { 0%{opacity:.95} 50%{opacity:.45} 100%{opacity:.95} }

    .moon{ position:absolute; top:6vh; right:8vw; width:min(160px,24vw); aspect-ratio:1; border-radius:50%; z-index:3;
      background: radial-gradient(circle at 35% 35%, #fff 0 35%, var(--moon) 60%, rgba(255,255,255,.12) 62%, transparent 65%), var(--moon);
      box-shadow: 0 0 35px 10px rgba(255,224,130,.4), 0 0 140px 40px rgba(255,224,130,.22);
    }

    /* ====== Lanterns ====== */
    .lantern{ position:absolute; bottom:-160px; width:72px; height:96px; border-radius:28px; background: linear-gradient(180deg, #ffe7a6, #ffc251);
      box-shadow: 0 0 20px 8px rgba(255,190,60,.55); transform-origin:50% -70px; z-index:2; 
      animation: rise 18s linear infinite, swing 4.2s ease-in-out infinite;
    }
    .lantern::before{ /* tassel */
      content:""; position:absolute; left:50%; bottom:-26px; transform:translateX(-50%);
      width:4px; height:24px; background: linear-gradient(var(--accent), #e07a00)
    }
    .lantern::after{ /* flame */
      content:""; position:absolute; left:50%; bottom:12px; transform:translateX(-50%);
      width:14px; height:20px; border-radius:50% 50% 45% 45%;
      background: radial-gradient(circle at 50% 30%, #fff 30%, #ffd166 60%, rgba(255,160,0,.35) 75%);
      filter: blur(.4px); animation: flicker .9s infinite alternate;
    }
    @keyframes flicker{ from{ transform:translateX(-50%) scale(1)} to{ transform:translateX(-50%) scale(1.08)} }
    @keyframes rise{ from{ transform:translateY(0) } to{ transform:translateY(-130vh) } }
    @keyframes swing{ 0%{ rotate:-4deg } 50%{ rotate:4deg } 100%{ rotate:-4deg } }

    /* A few variations & depths (translateZ) */
    .l1{ left:8vw; animation-delay:0s,.2s; transform: translateZ(-120px); }
    .l2{ left:22vw; width:60px; height:82px; animation-delay:4s,.1s; transform: translateZ(-60px); }
    .l3{ left:42vw; width:66px; height:88px; animation-delay:8s,.4s; transform: translateZ(-200px); }
    .l4{ left:64vw; animation-delay:12s,.3s; transform: translateZ(-20px); }
    .l5{ left:82vw; width:56px; height:76px; animation-delay:2s,.6s; transform: translateZ(-140px); }

    /* ====== Content card (glassmorphism) ====== */
    .center{ position:absolute; inset:0; display:grid; place-items:center; z-index:5; pointer-events:none }
    .card{ width:min(860px, 92vw); background:var(--glass); border:1px solid var(--stroke); padding:28px 24px 36px; border-radius:24px; 
      backdrop-filter: blur(10px); box-shadow:0 14px 48px rgba(0,0,0,.45); transform-style:preserve-3d;
    }
    h1{ font-size: clamp(28px, 4vw, 44px); margin:8px 0 6px }
    .subtitle{ color:#e6f0ff; opacity:.92; font-size:clamp(16px, 2.5vw, 20px); margin:0 }
    .highlight{ color:var(--accent) }
    .msg{ margin-top:14px; font-size:clamp(16px, 2.5vw, 19px); line-height:1.7 }

    .wishes{ display:flex; gap:10px; flex-wrap:wrap; margin-top:16px }
    .chip{ padding:8px 12px; border-radius:999px; background:rgba(255,255,255,.09); border:1px solid rgba(255,255,255,.15); font-size:14px }

    .actions{ margin-top:18px; display:flex; gap:12px; flex-wrap:wrap; pointer-events:auto }
    .btn{ all:unset; cursor:pointer; padding:12px 16px; border-radius:12px; font-weight:700; }
    .btn.primary{ background:linear-gradient(90deg, #ffcf66, #ff9f43); color:#271a00; box-shadow:0 6px 18px rgba(255,183,77,.35) }
    .btn.secondary{ background:rgba(255,255,255,.1); color:#fff; border:1px solid rgba(255,255,255,.2) }

    footer{ position:absolute; left:0; right:0; bottom:10px; text-align:center; font-size:13px; opacity:.8; z-index:6 }
    a{ color:#ffe082 }

    /* Mobile tune */
    @media (max-width:560px){ .moon{ width:110px; right:5vw } }
  </style>
</head>
<body>
  <div class="viewport" id="viewport">
    <div class="scene" id="scene">
      <!-- depth: farther elements should use more negative translateZ -->
      <div class="stars" style="transform: translateZ(-400px)"></div>
      <div class="moon" style="transform: translateZ(-260px)"></div>
      <!-- Lanterns (various Z) -->
      <div class="lantern l1"></div>
      <div class="lantern l2"></div>
      <div class="lantern l3"></div>
      <div class="lantern l4"></div>
      <div class="lantern l5"></div>

      <div class="center" style="transform: translateZ(0px)">
        <section class="card" aria-label="Thi·ªáp ch√∫c m·ª´ng Trung Thu">
          <p class="subtitle">G·ª≠i <span id="toName" class="highlight">b·∫°n th√¢n</span> üéë</p>
          <h1>Ch√∫c m·ª´ng <span class="highlight">T·∫øt Trung Thu</span>!</h1>
          <p class="msg" id="message">Ch√∫c b·∫°n v√† gia ƒë√¨nh m·ªôt ƒë√™m r·∫±m trƒÉng s√°ng, b√¨nh an v√† tr√≤n ƒë·∫ßy nh∆∞ chi·∫øc b√°nh trung thu. Mong m·ªçi ƒëi·ªÅu t·ªët l√†nh s·∫Ω gh√© ƒë·∫øn, c√¥ng vi·ªác h·ªçc t·∫≠p thu·∫≠n l·ª£i, n·ª• c∆∞·ªùi lu√¥n n·ªü tr√™n m√¥i.</p>

          <div class="wishes">
            <div class="chip">üåï TrƒÉng tr√≤n sum v·∫ßy</div>
            <div class="chip">üèÆ ƒê√®n l·ªìng r·ª±c r·ª°</div>
            <div class="chip">ü•Æ Ng·ªçt ng√†o ƒëo√†n vi√™n</div>
            <div class="chip">‚ú® B√¨nh an nh∆∞ √Ω</div>
          </div>

          <div class="actions">
            <button class="btn primary" id="copyBtn">Sao ch√©p link thi·ªáp</button>
            <button class="btn secondary" id="musicBtn">‚ñ∂Ô∏è Ph√°t nh·∫°c</button>
          </div>
        </section>
      </div>
    </div>
  </div>

  <footer>
    <span id="fromName">T·ª´ ng∆∞·ªùi b·∫°n c·ªßa b·∫°n üíõ</span>
  </footer>

  <!-- Nh·∫°c: th√™m link mp3 h·ª£p l·ªá v√†o source b√™n d∆∞·ªõi -->
  <audio id="bgm" preload="none">
    <source src="C:\Users\Mr Vinh\Downloads\Ghi √Çm\a.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ========= Personalize from URL =========
    const qs = new URLSearchParams(location.search);
    const to = qs.get('to');
    const from = qs.get('from');
    const msg = qs.get('msg');
    if (to) document.getElementById('toName').textContent = to;
    if (from) document.getElementById('fromName').textContent = `Th√¢n g·ª≠i t·ª´ ${from} üíõ`;
    if (msg) document.getElementById('message').textContent = msg;

    // ========= Copy current link =========
    const copyBtn = document.getElementById('copyBtn');
    copyBtn.addEventListener('click', async () => {
      try{
        await navigator.clipboard.writeText(location.href);
        copyBtn.textContent = '‚úîÔ∏è ƒê√£ sao ch√©p';
        setTimeout(()=> copyBtn.textContent = 'Sao ch√©p link thi·ªáp', 1600);
      }catch(e){ alert('H√£y copy th·ªß c√¥ng: '+location.href) }
    });

    // ========= Music control =========
    const musicBtn = document.getElementById('musicBtn');
    const bgm = document.getElementById('bgm');
    let playing = false;
    musicBtn.addEventListener('click', async () => {
      try{
        if (!bgm.src){
          // G·ª£i √Ω: ƒë·∫∑t link nh·∫°c c·ªßa b·∫°n ·ªü ƒë√¢y (mp3 public)
        bgm.src = 'C:/Users/Mr Vinh/Downloads/Ghi √Çm/a.mp3'
        }
        if (!playing){ await bgm.play(); playing = true; musicBtn.textContent = '‚è∏Ô∏è T·∫°m d·ª´ng nh·∫°c'; }
        else{ bgm.pause(); playing = false; musicBtn.textContent = '‚ñ∂Ô∏è Ph√°t nh·∫°c'; }
      }catch(e){ alert('B·∫•m l·∫°i ƒë·ªÉ c·∫•p quy·ªÅn ph√°t nh·∫°c.'); }
    });

    // ========= 3D Parallax by mouse =========
    const viewport = document.getElementById('viewport');
    const scene = document.getElementById('scene');

    const clamp = (n, min, max) => Math.max(min, Math.min(max, n));

    function onPointerMove(e){
      const rect = viewport.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      const x = (e.clientX - cx) / (rect.width/2);  // -1..1
      const y = (e.clientY - cy) / (rect.height/2); // -1..1

      // Rotate the whole scene a tiny bit and shift
      const rotY = clamp(x * 6, -8, 8); // yaw
      const rotX = clamp(-y * 4, -6, 6); // pitch
      const tx = clamp(x * 20, -24, 24);
      const ty = clamp(y * 16, -18, 18);
      scene.style.transform = `translate3d(${tx}px, ${ty}px, 0) rotateX(${rotX}deg) rotateY(${rotY}deg)`;
    }

    function onLeave(){
      scene.style.transform = `translate3d(0,0,0) rotateX(0deg) rotateY(0deg)`;
    }

    viewport.addEventListener('pointermove', onPointerMove);
    viewport.addEventListener('pointerleave', onLeave);

    // ========= Optional: spawn extra lanterns over time =========
    // Creates gentle variety without images
    const spawn = () => {
      const l = document.createElement('div');
      l.className = 'lantern';
      const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
      l.style.left = Math.round( (10 + Math.random()*80) ) + 'vw';
      const w = 52 + Math.random()*36; // 52..88
      const h = 0.75 * w + 12;
      l.style.width = w + 'px';
      l.style.height = h + 'px';
      const delay = (Math.random()*14).toFixed(2) + 's';
      l.style.animationDelay = `${delay}, ${(Math.random()*0.8).toFixed(2)}s`;
      const z = -40 - Math.random()*240; // depth
      l.style.transform = `translateZ(${z}px)`;
      scene.appendChild(l);
      // remove after one full rise
      setTimeout(()=> l.remove(), 18000);
    };
    setInterval(spawn, 3500);
  </script>
</body>
</html>
